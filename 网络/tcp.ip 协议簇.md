### 简介

> tcp/ip 协议簇是一个分层，多协议的通信体制，四层协议系统，自底而上分别是 数据链路层、网络层、传输层、应用层。

#### 数据链路层

> 主要实现网卡的网络驱动程序，以处理数据在物理媒介上的传输。

- 主要有 ARP （address resolve protocol）地址解析协议和 RARP（reverse address resolve protocol） 逆地址解析协议
- 网络层通过ip地址寻址一机器，而数据链路层通过物理地址寻址一机器，所以网络层必须把ip地址转化为物理地址，从而能使用数据链路层提供的服务，这就是ARP提供的服务。
- 有些无盘网络工作站由于没有存储设备，就无法记住自己的ip地址，所以需要借助网络上的网卡中 物理地址向网络管理者(服务器或网络管理程序)上存储的物理地址-ip映射来找到自己的ip，RARP 协议就应用在此处。

#### 网络层

> 实现数据包的转路和分发。WAN（wide area network） 广域网 、LAN （local area network）
两台机器一般不是直接连接，而是通过很多中间节点（路由器）连接。

- 主要协议 IP（internet protocol）因特网协议 ，ICMP（internet control message protocol）因特网控制报文协议
- ip协议是通过数据包的目的ip地址来决定数据包如何传递的，如果不能直接传递给目的地址，则寻找一个合适的节点进行转发，重复这一过程直到传递到目的地址，或发送失败则丢弃。
- ICMP ，是ip协议的补充，主要用于测试网络连接。

#### 传输层

> 传输层是基于端对端，不像网络层是逐跳的通信方式，传输层只关心通信的开始端和目的端，而不在乎数据包的中转过程。

- 主要有 TCP （transmission control protocol）传输控制协议 和 UDP （user datagram protocol）用户数据协议

##### tcp

- 提供可靠的，面向连接和基于流(stream)的服务
- 超时重传，数据确认的多种方式来确保数据安全到达目的端
- 使用tcp 协议双方必须先连接，内核或缓存连接的其他信息，当关闭连接，内核就会释放这些资源
- 不限制数据长度，发送端可以不断逐字写入数据，接收端可以不断逐字接收数据

##### udp

- 是不可靠，无连接，基于数据包的服务
- 数据在传输中丢失，丢弃 udp 只会通知应用发送失败，用户通常要自己做超时重传、数据确认等工作
- 通信双方不是保持一个长的连接，必须每次发送数据都要指定明确的地址
- 数据包都有一定长度，接收端必须指定接收的长度一次性读出，超出会被丢弃。

#### 应用层

> 处理应用程序的逻辑

### 封装

> 上层协议如何使用下层协议，应用数据在发送到物理网络上之前，都将通过协议栈从上到下，下一层都会在上一层的数据包基础上加上自己的头部信息（或者尾部信息）

- tcp 报文段（tcp message segment）
- udp 数据包（udp datagram）
- ip 数据包（ip datagram）
-  经过数据链路层封装的叫做帧 frame

### 分用

>  从帧到目的应用，从协议簇自底向上进行帧的处理，是最终处理后的数据传递给目的应用